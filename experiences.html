<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Crowdplzr Streaming</title>

  <!-- Tailwind with aspect-ratio plugin -->
  <script src="https://cdn.tailwindcss.com?plugins=aspect-ratio"></script>

  <style>
    .scrollbar-hide::-webkit-scrollbar{display:none}
    .scrollbar-hide{-ms-overflow-style:none;scrollbar-width:none}
    @media (max-width:640px){
      #closeBtn{width:3rem;height:2.5rem;font-size:2.5rem}
    }
    #closeBtn{position:relative}
    #closeBtn::after{content:"";position:absolute;inset:-0.75rem}
    .chevron-btn {
      transition: opacity 0.2s;
      opacity: 0.85;
      width: 3rem;
      height: 3rem;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .chevron-btn svg {
      width: 2.25rem;
      height: 2.25rem;
    }
    .chevron-btn:hover {
      opacity: 1;
      background: white;
    }
    @media (max-width: 640px) {
      .chevron-btn {
        width: 4rem;
        height: 4rem;
        padding: 1rem;
      }
      .chevron-btn svg {
        width: 3rem;
        height: 3rem;
      }
    }
  </style>
</head>

<body class="bg-black text-white font-sans">

  <!-- ───── HEADER ───── -->
  <header class="fixed top-0 inset-x-0 z-50 flex items-center justify-between px-8 py-4 bg-black/80 backdrop-blur-sm">
    <h1 class="text-2xl font-extrabold tracking-tight">Crowdplzr</h1>
    <nav class="hidden md:flex space-x-6 text-sm font-medium">
      <a href="#" class="hover:text-red-500">Home</a>
      <a href="#" class="hover:text-red-500">Browse</a>
      <a href="#" class="hover:text-red-500">My List</a>
    </nav>
    <button class="px-3 py-1.5 bg-red-600 rounded text-sm font-semibold hover:bg-red-700">Sign In</button>
  </header>

  <!-- ───── HERO ───── -->
  <section class="relative h-[60vh] w-full overflow-hidden pt-16">
    <video src="assets/rb.mp4" autoplay muted loop playsinline class="absolute inset-0 w-full h-full object-cover"></video>
    <div class="absolute inset-0 bg-gradient-to-t from-black via-black/40 to-transparent"></div>
    <div class="relative z-10 max-w-xl p-8 mt-24 space-y-4">
      <h2 class="text-4xl md:text-5xl font-extrabold">Featured Experience</h2>
      <p class="text-sm md:text-base">Drop audiences straight into blockbuster-scale worlds.</p>
      <button class="flex items-center gap-2 px-5 py-2 bg-red-600 rounded-md text-sm font-semibold hover:bg-red-700">
        ▶ Play Trailer
      </button>
    </div>
  </section>

<!-- ───── ROW : Popular Now ───── -->
<section class="space-y-3 px-6 py-8">
  <h3 class="text-lg md:text-xl font-bold px-1">Popular Now</h3>
  <div class="relative min-h-[13rem]">
    <!-- Chevrons with spacing and larger size -->
    <button class="chevron-btn left-2 top-1/2 -translate-y-1/2 absolute z-10 bg-white/80 text-black rounded-full p-3 shadow" data-chevron="left" aria-label="Scroll left">
      <svg xmlns="http://www.w3.org/2000/svg" class="w-7 h-7" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M15 19l-7-7 7-7"/></svg>
    </button>
    <button class="chevron-btn right-2 top-1/2 -translate-y-1/2 absolute z-10 bg-white/80 text-black rounded-full p-3 shadow" data-chevron="right" aria-label="Scroll right">
      <svg xmlns="http://www.w3.org/2000/svg" class="w-7 h-7" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M9 5l7 7-7 7"/></svg>
    </button>
    <div class="flex items-center gap-4 overflow-x-auto scrollbar-hide pb-4 scroll-row">
      <!-- EOTW -->
      <div class="relative w-48 flex-shrink-0 group cursor-pointer" data-src="assets/eotw.mp4">
        <img src="assets/eotw.jpg" alt="End of the World" class="w-full aspect-square object-cover rounded-xl" loading="lazy">
        <video src="assets/eotw.mp4" muted loop playsinline class="absolute inset-0 w-full h-full object-cover rounded-xl opacity-0 group-hover:opacity-100 transition-opacity duration-300"></video>
      </div>
      <!-- URGC -->
      <div class="relative w-48 flex-shrink-0 group cursor-pointer" data-src="assets/Urgc.mp4">
        <img src="assets/urgc.jpg" alt="Underground Rebel Gameshow" class="w-full aspect-square object-cover rounded-xl" loading="lazy">
        <video src="assets/Urgc.mp4" muted loop playsinline class="absolute inset-0 w-full h-full object-cover rounded-xl opacity-0 group-hover:opacity-100 transition-opacity duration-300"></video>
      </div>
      <!-- TTM -->
      <div class="relative w-48 flex-shrink-0 group cursor-pointer" data-src="assets/Ttm.mp4">
        <img src="assets/ttm.jpg" alt="Twisted Time Machine" class="w-full aspect-square object-cover rounded-xl" loading="lazy">
        <video src="assets/Ttm.mp4" muted loop playsinline class="absolute inset-0 w-full h-full object-cover rounded-xl opacity-0 group-hover:opacity-100 transition-opacity duration-300"></video>
      </div>
      <!-- RB -->
      <div class="relative w-48 flex-shrink-0 group cursor-pointer" data-src="assets/rb.mp4">
        <img src="assets/rb.jpg" alt="Rebel Bingo" class="w-full aspect-square object-cover rounded-xl" loading="lazy">
        <video src="assets/rb.mp4" muted loop playsinline class="absolute inset-0 w-full h-full object-cover rounded-xl opacity-0 group-hover:opacity-100 transition-opacity duration-300"></video>
      </div>
      <!-- Cat Face -->
      <div class="relative w-48 flex-shrink-0 group cursor-pointer" data-src="assets/CatFace.mp4">
        <img src="assets/catface.png" alt="Cat Face" class="w-full aspect-square object-cover rounded-xl" loading="lazy">
        <video src="assets/CatFace.mp4" muted loop playsinline class="absolute inset-0 w-full h-full object-cover rounded-xl opacity-0 group-hover:opacity-100 transition-opacity duration-300"></video>
      </div>
      <!-- Lycra -->
      <div class="relative w-48 flex-shrink-0 group cursor-pointer" data-src="assets/Lycra.mp4">
        <img src="assets/lycra.png" alt="Lycra 80s Party" class="w-full aspect-square object-cover rounded-xl" loading="lazy">
        <video src="assets/Lycra.mp4" muted loop playsinline class="absolute inset-0 w-full h-full object-cover rounded-xl opacity-0 group-hover:opacity-100 transition-opacity duration-300"></video>
      </div>
    </div>
  </div>
</section>

<!-- ───── ROW : Coming Soon ───── -->
<section class="space-y-3 px-6 py-8">
  <h3 class="text-lg md:text-xl font-bold px-1">Coming Soon</h3>
  <div class="relative min-h-[13rem]">
    <button class="chevron-btn left-2 top-1/2 -translate-y-1/2 absolute z-10 bg-white/80 text-black rounded-full p-3 shadow" data-chevron="left" aria-label="Scroll left">
      <svg xmlns="http://www.w3.org/2000/svg" class="w-7 h-7" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M15 19l-7-7 7-7"/></svg>
    </button>
    <button class="chevron-btn right-2 top-1/2 -translate-y-1/2 absolute z-10 bg-white/80 text-black rounded-full p-3 shadow" data-chevron="right" aria-label="Scroll right">
      <svg xmlns="http://www.w3.org/2000/svg" class="w-7 h-7" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M9 5l7 7-7 7"/></svg>
    </button>
    <div class="flex items-center gap-4 overflow-x-auto scrollbar-hide pb-4 scroll-row">
      <!-- SNOOZEFEST -->
      <div class="relative w-48 flex-shrink-0 group cursor-pointer" data-src="assets/SNZF.mp4">
        <img src="assets/SNOOZEFESTSQ.png" alt="Snoozefest Pajama Party" class="w-full aspect-square object-cover rounded-xl" loading="lazy">
        <video src="assets/SNZF.mp4" muted loop playsinline class="absolute inset-0 w-full h-full object-cover rounded-xl opacity-0 group-hover:opacity-100 transition-opacity duration-300"></video>
      </div>
      <!-- HOEDOWN -->
      <div class="relative w-48 flex-shrink-0 group cursor-pointer" data-src="assets/hoedown.mp4">
        <img src="assets/hoedown.png" alt="Hoedown Showdown" class="w-full aspect-square object-cover rounded-xl" loading="lazy">
        <video src="assets/hoedown.mp4" muted loop playsinline class="absolute inset-0 w-full h-full object-cover rounded-xl opacity-0 group-hover:opacity-100 transition-opacity duration-300"></video>
      </div>
    </div>
  </div>
</section>

<!-- ───── ROW : Corporate ───── -->
<section class="space-y-3 px-6 py-8">
  <h3 class="text-lg md:text-xl font-bold px-1">Corporate Events & Keynotes</h3>
  <div class="relative min-h-[13rem]">
    <button class="chevron-btn left-2 top-1/2 -translate-y-1/2 absolute z-10 bg-white/80 text-black rounded-full p-3 shadow" data-chevron="left" aria-label="Scroll left">
      <svg xmlns="http://www.w3.org/2000/svg" class="w-7 h-7" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M15 19l-7-7 7-7"/></svg>
    </button>
    <button class="chevron-btn right-2 top-1/2 -translate-y-1/2 absolute z-10 bg-white/80 text-black rounded-full p-3 shadow" data-chevron="right" aria-label="Scroll right">
      <svg xmlns="http://www.w3.org/2000/svg" class="w-7 h-7" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M9 5l7 7-7 7"/></svg>
    </button>
    <div class="flex items-center gap-4 overflow-x-auto scrollbar-hide pb-4 scroll-row">
      <!-- KILLER KEYNOTE -->
      <div class="relative w-48 flex-shrink-0 group cursor-pointer" data-src="assets/keynote.mp4">
        <img src="assets/keynote.png" alt="Killer Keynote" class="w-full aspect-square object-cover rounded-xl" loading="lazy">
        <video src="assets/keynote.mp4" muted loop playsinline class="absolute inset-0 w-full h-full object-cover rounded-xl opacity-0 group-hover:opacity-100 transition-opacity duration-300"></video>
      </div>
      <!-- PERFECT PANEL -->
      <div class="relative w-48 flex-shrink-0 group cursor-pointer" data-src="assets/keynote.mp4">
        <img src="assets/PANELS.png" alt="Perfect Panel" class="w-full aspect-square object-cover rounded-xl" loading="lazy">
        <video src="assets/keynote.mp4" muted loop playsinline class="absolute inset-0 w-full h-full object-cover rounded-xl opacity-0 group-hover:opacity-100 transition-opacity duration-300"></video>
      </div>
    </div>
  </div>
</section>

<!-- ───── OVERLAY PLAYER ───── -->
<div id="overlay" class="fixed inset-0 bg-black/90 flex items-center justify-center z-50 hidden">
  <div class="relative flex flex-col items-center w-full max-w-2xl px-4">
    <video id="overlayVid" class="max-h-[45vh] w-full rounded-xl mb-6" controls></video>
    <div id="overlayText" class="w-full text-white text-center mt-2 mb-4"></div>
    <button id="closeBtn" class="absolute top-4 right-4 text-white text-4xl font-bold leading-none">&times;</button>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded',()=>{
  /* ---------- Overlay logic ---------- */
  const overlay    = document.getElementById('overlay');
  const overlayVid = document.getElementById('overlayVid');
  const overlayText = document.getElementById('overlayText');
  const closeBtn   = document.getElementById('closeBtn');

  // Map video src to title/description (replace with real content later)
  const videoMeta = {
    "assets/eotw.mp4": {
      title: "End of the World",
      desc: `<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque euismod, nisi eu consectetur.</p>
             <p>Aliquam erat volutpat. Etiam nec velit nec libero pretium pharetra.</p>`
    },
    "assets/Urgc.mp4": {
      title: "Underground Rebel Gameshow",
      desc: `<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque euismod, nisi eu consectetur.</p>
             <p>Aliquam erat volutpat. Etiam nec velit nec libero pretium pharetra.</p>`
    },
    "assets/Ttm.mp4": {
      title: "Twisted Time Machine",
      desc: `<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque euismod, nisi eu consectetur.</p>
             <p>Aliquam erat volutpat. Etiam nec velit nec libero pretium pharetra.</p>`
    },
    "assets/rb.mp4": {
      title: "Rebel Bingo",
      desc: `<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque euismod, nisi eu consectetur.</p>
             <p>Aliquam erat volutpat. Etiam nec velit nec libero pretium pharetra.</p>`
    },
    "assets/CatFace.mp4": {
      title: "Cat Face",
      desc: `<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque euismod, nisi eu consectetur.</p>
             <p>Aliquam erat volutpat. Etiam nec velit nec libero pretium pharetra.</p>`
    },
    "assets/Lycra.mp4": {
      title: "Lycra 80s Party",
      desc: `<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque euismod, nisi eu consectetur.</p>
             <p>Aliquam erat volutpat. Etiam nec velit nec libero pretium pharetra.</p>`
    },
    "assets/SNZF.mp4": {
      title: "Snoozefest Pajama Party",
      desc: `<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque euismod, nisi eu consectetur.</p>
             <p>Aliquam erat volutpat. Etiam nec velit nec libero pretium pharetra.</p>`
    },
    "assets/hoedown.mp4": {
      title: "Hoedown Showdown",
      desc: `<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque euismod, nisi eu consectetur.</p>
             <p>Aliquam erat volutpat. Etiam nec velit nec libero pretium pharetra.</p>`
    },
    "assets/keynote.mp4": {
      title: "Killer Keynote",
      desc: `<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque euismod, nisi eu consectetur.</p>
             <p>Aliquam erat volutpat. Etiam nec velit nec libero pretium pharetra.</p>`
    }
  };

  closeBtn.addEventListener('click',()=>{
    overlayVid.pause();
    overlayVid.removeAttribute('src');
    overlayVid.load();
    overlay.classList.add('hidden');
    overlayText.innerHTML = "";
  });

  const cards = document.querySelectorAll('[data-src]');

  function showOverlay(src) {
    overlayVid.src = src;
    overlay.classList.remove('hidden');
    overlayVid.play();
    // Set overlay text
    const meta = videoMeta[src] || {title: "Experience", desc: "<p>Lorem ipsum dolor sit amet.</p>"};
    overlayText.innerHTML = `<h2 class="text-2xl md:text-3xl font-bold mb-2">${meta.title}</h2>
      <div class="text-base md:text-lg leading-relaxed">${meta.desc}</div>`;
  }

  // Desktop: click to open overlay
  function isTouchDevice() {
    return matchMedia('(pointer: coarse)').matches;
  }
  if (!isTouchDevice()) {
    cards.forEach(card=>{
      card.addEventListener('click',()=>{
        showOverlay(card.dataset.src);
      });
    });
  }

  // Hover previews (desktop)
  cards.forEach(card=>{
    const preview = card.querySelector('video');
    preview.preload = 'metadata';

    const startPreview = ()=>{
      preview.currentTime = preview.duration > 2 ? 2 : 0.1;
      preview.play();
    };

    card.addEventListener('mouseenter',()=>{
      if(preview.readyState>=2){
        startPreview();
      }else{
        preview.addEventListener('loadedmetadata',startPreview,{once:true});
      }
    });

    card.addEventListener('mouseleave',()=>{
      preview.pause();
      preview.currentTime = 0;
    });
  });

  // Touch devices: tap to preview, second tap to play
  if(isTouchDevice()){
    cards.forEach(card=>{
      const preview = card.querySelector('video');
      let tapped = false;
      card.addEventListener('touchend',e=>{
        e.preventDefault();
        if(!tapped){
          // First tap: show preview
          tapped = true;
          preview.currentTime = preview.duration > 2 ? 2 : 0.1;
          preview.play();
          preview.style.opacity = 1;
          setTimeout(()=>{ tapped = false; }, 400);
        }else{
          // Second tap: open overlay player
          preview.pause();
          preview.currentTime = 0;
          preview.style.opacity = 0;
          showOverlay(card.dataset.src);
          tapped = false;
        }
      },{passive:false});
    });
  }

  // Infinite Chevron scroll logic
  document.querySelectorAll('.scroll-row').forEach(row => {
    const container = row;
    const parent = container.parentElement;
    const leftBtn = parent.querySelector('[data-chevron="left"]');
    const rightBtn = parent.querySelector('[data-chevron="right"]');
    const cards = Array.from(container.children);
    const cardCount = cards.length;
    const cloneCount = Math.min(3, cardCount);

    // Only enable infinite scroll if there are 6 or more cards
    if(cardCount >= 6) {
      for(let i=0;i<cloneCount;i++){
        container.appendChild(cards[i].cloneNode(true));
        container.insertBefore(cards[cardCount-1-i].cloneNode(true), container.firstChild);
      }

      function setToRealStart() {
        const cardWidth = cards[0].offsetWidth + parseInt(getComputedStyle(cards[0]).marginRight);
        container.scrollLeft = cardWidth * cloneCount;
      }
      setTimeout(setToRealStart, 50);

      container.addEventListener('scroll', () => {
        const cardWidth = cards[0].offsetWidth + parseInt(getComputedStyle(cards[0]).marginRight);
        if (container.scrollLeft < cardWidth * 0.5) {
          container.scrollLeft = cardWidth * cardCount + container.scrollLeft;
        } else if (container.scrollLeft > cardWidth * (cardCount + cloneCount - 0.5)) {
          container.scrollLeft = container.scrollLeft - cardWidth * cardCount;
        }
      });

      window.addEventListener('resize', setToRealStart);
    }

    // Chevrons always visible
    function updateChevrons() {
      leftBtn.classList.remove('hidden');
      rightBtn.classList.remove('hidden');
    }
    updateChevrons();

    leftBtn.addEventListener('click', () => {
      const cardWidth = cards[0].offsetWidth + parseInt(getComputedStyle(cards[0]).marginRight);
      container.scrollBy({ left: -cardWidth, behavior: 'smooth' });
    });
    rightBtn.addEventListener('click', () => {
      const cardWidth = cards[0].offsetWidth + parseInt(getComputedStyle(cards[0]).marginRight);
      container.scrollBy({ left: cardWidth, behavior: 'smooth' });
    });
  });
});